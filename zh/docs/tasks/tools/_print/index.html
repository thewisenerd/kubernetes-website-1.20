<!doctype html><html lang=zh class=no-js><head><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-36037335-10')</script><link rel=alternate hreflang=en href=https://kubernetes.io/docs/tasks/tools/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/tasks/tools/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/tasks/tools/><link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/tasks/tools/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/tasks/tools/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/tasks/tools/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/tasks/tools/><link rel=alternate hreflang=vi href=https://kubernetes.io/vi/docs/tasks/tools/><link rel=alternate hreflang=ru href=https://kubernetes.io/ru/docs/tasks/tools/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.82.0"><link rel=canonical type=text/html href=https://kubernetes.io/zh/docs/tasks/tools/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>安装工具 | Kubernetes</title><meta property="og:title" content="安装工具"><meta property="og:description" content="在你的计算机上设置 Kubernetes 工具。"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/zh/docs/tasks/tools/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="安装工具"><meta itemprop=description content="在你的计算机上设置 Kubernetes 工具。"><meta name=twitter:card content="summary"><meta name=twitter:title content="安装工具"><meta name=twitter:description content="在你的计算机上设置 Kubernetes 工具。"><link rel=preload href=/scss/main.min.aeea2a074ae7ac3d467a0d6f52e45894b49452cbb3f0f410c268ec7280c5a653.css as=style><link href=/scss/main.min.aeea2a074ae7ac3d467a0d6f52e45894b49452cbb3f0f410c268ec7280c5a653.css rel=stylesheet integrity><script src=/js/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png"}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content="在你的计算机上设置 Kubernetes 工具。"><meta property="og:description" content="在你的计算机上设置 Kubernetes 工具。"><meta name=twitter:description content="在你的计算机上设置 Kubernetes 工具。"><meta property="og:url" content="https://kubernetes.io/zh/docs/tasks/tools/"><meta property="og:title" content="安装工具"><meta name=twitter:title content="安装工具"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/script.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/zh/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/zh/docs/>文档</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/blog/>Kubernetes 博客</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/training/>培训</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/partners/>合作伙伴</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/community/>社区</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/case-studies/>案例分析</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>版本列表</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://kubernetes.io/zh/docs/tasks/tools/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/zh/docs/tasks/tools/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/zh/docs/tasks/tools/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/zh/docs/tasks/tools/>v1.21</a>
<a class=dropdown-item href=https://v1-20.docs.kubernetes.io/zh/docs/tasks/tools/>v1.20</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文 Chinese</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/tasks/tools/>English</a>
<a class=dropdown-item href=/ko/docs/tasks/tools/>한국어 Korean</a>
<a class=dropdown-item href=/ja/docs/tasks/tools/>日本語 Japanese</a>
<a class=dropdown-item href=/fr/docs/tasks/tools/>Français</a>
<a class=dropdown-item href=/de/docs/tasks/tools/>Deutsch</a>
<a class=dropdown-item href=/es/docs/tasks/tools/>Español</a>
<a class=dropdown-item href=/id/docs/tasks/tools/>Bahasa Indonesia</a>
<a class=dropdown-item href=/vi/docs/tasks/tools/>Tiếng Việt</a>
<a class=dropdown-item href=/ru/docs/tasks/tools/>Русский</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.</p><p><a href=/zh/docs/tasks/tools/>返回本页常规视图</a>.</p></div><h1 class=title>安装工具</h1><div class=lead>在你的计算机上设置 Kubernetes 工具。</div><ul><li>1: <a href=#pg-37b6179f23c8ad977cb9daa6d2da748a>在 Linux 系统中安装并设置 kubectl</a></li><li>2: <a href=#pg-961fc70b732cb8df4fd11a3463b6545c>在 macOS 系统上安装和设置 kubectl</a></li><li>3: <a href=#pg-bbdc530b292ab4074d1dfe69feafb3e7>安装并配置 kubectl</a></li><li>4: <a href=#pg-2d600cc8ec4dec69673b5f9577b6da22>Linux 系统中的 bash 自动补全功能</a></li><li>5: <a href=#pg-68808b3ec5807517ed64fd8ae32a7d1b>macOS 系统上的 bash 自动补全</a></li><li>6: <a href=#pg-9ab27577326839cb4793fd670a916364>zsh 自动补全</a></li><li>7: <a href=#pg-99d563e9521796074ba3ca7f15a613ce>后续内容</a></li><li>8: <a href=#pg-f92adff24b39ef90a481e9aec2b8dd08>通过 gcloud 安装 kubectl</a></li><li>9: <a href=#pg-b2d43b2ae3e8f26eefa83de2db4ba782>验证 kubectl 的安装效果</a></li></ul><div class=content><h2 id=kubectl>kubectl</h2><p>Kubernetes 命令行工具，<a href=/docs/reference/kubectl/kubectl/>kubectl</a>，使得你可以对 Kubernetes 集群运行命令。
你可以使用 kubectl 来部署应用、监测和管理集群资源以及查看日志。</p><p>有关更多信息，包括 kubectl 操作的完整列表，请参见<a href=/zh/docs/reference/kubectl/><code>kubectl</code>
参考文件</a>。</p><p>kubectl 可安装在各种 Linux 平台、 macOS 和 Windows 上。
在下面找到你喜欢的操作系统。</p><ul><li><a href=/zh/docs/tasks/tools/install-kubectl-linux>在 Linux 上安装 kubectl</a></li><li><a href=/zh/docs/tasks/tools/install-kubectl-macos>在 macOS 上安装 kubectl</a></li><li><a href=/zh/docs/tasks/tools/install-kubectl-windows>在 Windows 上安装 kubectl</a></li></ul><h2 id=kind>kind</h2><p><a href=https://kind.sigs.k8s.io/docs/><code>kind</code></a> 让你能够在本地计算机上运行 Kubernetes。
<code>kind</code> 要求你安装并配置好 <a href=https://docs.docker.com/get-docker/>Docker</a>。</p><p>kind <a href=https://kind.sigs.k8s.io/docs/user/quick-start/>快速入门</a>页面展示了
开始使用 <code>kind</code> 所需要完成的操作。</p><p><a class="btn btn-primary" href=https://kind.sigs.k8s.io/docs/user/quick-start/ role=button aria-label="查看 kind 的快速入门指南">查看 kind 的快速入门指南</a></p><h2 id=minikube>minikube</h2><p>与 <code>kind</code> 类似，<a href=https://minikube.sigs.k8s.io/><code>minikube</code></a> 是一个工具，
能让你在本地运行 Kubernetes。
<code>minikube</code> 在你本地的个人计算机（包括 Windows、macOS 和 Linux PC）运行一个单节点的
Kubernetes 集群，以便你来尝试 Kubernetes 或者开展每天的开发工作。</p><p>如果你关注如何安装此工具，可以按官方的
<a href=https://minikube.sigs.k8s.io/docs/start/>Get Started!</a>指南操作。</p><p><a class="btn btn-primary" href=https://minikube.sigs.k8s.io/docs/start/ role=button aria-label="查看 minikube 快速入门指南">查看 minikube 快速入门指南</a></p><p>当你拥有了可工作的 <code>minikube</code> 时，就可以用它来
<a href=/zh/docs/tutorials/hello-minikube/>运行示例应用</a>了。</p><h2 id=kubeadm>kubeadm</h2><p>你可以使用 <a class=glossary-tooltip title="用来快速安装 Kubernetes 并搭建安全稳定的集群的工具。" data-toggle=tooltip data-placement=top href=/zh/docs/setup/production-environment/tools/kubeadm/ target=_blank aria-label=kubeadm>kubeadm</a> 工具来
创建和管理 Kubernetes 集群。
该工具能够执行必要的动作并用一种用户友好的方式启动一个可用的、安全的集群。</p><p><a href=/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/>安装 kubeadm</a>
展示了如何安装 kubeadm 的过程。
一旦安装了 kubeadm，你就可以使用它来
<a href=/zh/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>创建一个集群</a>。</p><p><a class="btn btn-primary" href=/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/ role=button aria-label="查看 kubeadm 安装指南">查看 kubeadm 安装指南</a></p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-37b6179f23c8ad977cb9daa6d2da748a>1 - 在 Linux 系统中安装并设置 kubectl</h1><h2 id=准备开始>准备开始</h2><p>kubectl 版本和集群版本之间的差异必须在一个小版本号内。
例如：v1.2 版本的客户端只能与 v1.1、v1.2 和 v1.3 版本的集群一起工作。
用最新版的 kubectl 有助于避免不可预见的问题。</p><h2 id=install-kubectl-on-linux>在 Linux 系统中安装 kubectl</h2><p>在 Linux 系统中安装 kubectl 有如下几种方法：</p><ul><li><a href=#%E5%87%86%E5%A4%87%E5%BC%80%E5%A7%8B>准备开始</a></li><li><a href=#install-kubectl-on-linux>在 Linux 系统中安装 kubectl</a><ul><li><a href=#install-kubectl-binary-with-curl-on-linux>用 curl 在 Linux 系统中安装 kubectl</a></li><li><a href=#install-using-native-package-management>用原生包管理工具安装</a></li><li><a href=#install-using-other-package-management>用其他包管理工具安装</a></li><li><a href=#install-on-linux-as-part-of-the-google-cloud-sdk>作为谷歌云 SDK 的一部分，在 Linux 中安装</a></li></ul></li><li><a href=#verify-kubectl-configration>验证 kubectl 配置</a></li><li><a href=#optional-kubectl-configurations>可选的 kubectl 配置</a><ul><li><a href=#enable-shell-autocompletion>启用 shell 自动补全功能</a></li></ul></li><li><a href=#%E6%8E%A5%E4%B8%8B%E6%9D%A5>接下来</a></li></ul><h3 id=install-kubectl-binary-with-curl-on-linux>用 curl 在 Linux 系统中安装 kubectl</h3><ol><li><p>用以下命令下载最新发行版：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/release/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/linux/amd64/kubectl&#34;</span>
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>如需下载某个指定的版本，请用指定版本号替换该命令的这一部分： <code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>。</p><p>例如，要在 Linux 中下载 v1.20.15 版本，请输入：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO https://dl.k8s.io/release/v1.20.15/bin/linux/amd64/kubectl
</code></pre></div></div></blockquote></li><li><p>验证该可执行文件（可选步骤）</p><p>下载 kubectl 校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/linux/amd64/kubectl.sha256&#34;</span>
</code></pre></div><p>基于校验和文件，验证 kubectl 的可执行文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>&lt;kubectl.sha256<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44> kubectl&#34;</span> | sha256sum --check
</code></pre></div><p>验证通过时，输出为：</p><pre><code class=language-console data-lang=console>kubectl: OK
</code></pre><p>验证失败时，<code>sha256</code> 将以非零值退出，并打印如下输出：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl: FAILED
sha256sum: WARNING: <span style=color:#666>1</span> computed checksum did NOT match
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>下载的 kubectl 与校验和文件版本必须相同。</div></blockquote></li><li><p>安装 kubectl</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo install -o root -g root -m <span style=color:#666>0755</span> kubectl /usr/local/bin/kubectl
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>即使你没有目标系统的 root 权限，仍然可以将 kubectl 安装到目录 <code>~/.local/bin</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p ~/.local/bin/kubectl
mv ./kubectl ~/.local/bin/kubectl
<span style=color:#080;font-style:italic># and then add ~/.local/bin/kubectl to $PATH</span>
</code></pre></div></div></blockquote></li><li><p>执行测试，以保障你安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=install-using-native-package-management>用原生包管理工具安装</h3><ul class="nav nav-tabs" id=kubectl-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-install-0 role=tab aria-controls=kubectl-install-0 aria-selected=true>Ubuntu、Debian 或 HypriotOS</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-install-1 role=tab aria-controls=kubectl-install-1>CentOS、RHEL 或 Fedora</a></li></ul><div class=tab-content id=kubectl-install><div id=kubectl-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-install-0><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
sudo apt-get update <span style=color:#666>&amp;&amp;</span> sudo apt-get install -y apt-transport-https gnupg2 curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
<span style=color:#a2f>echo</span> <span style=color:#b44>&#34;deb https://apt.kubernetes.io/ kubernetes-xenial main&#34;</span> | sudo tee -a /etc/apt/sources.list.d/kubernetes.list
sudo apt-get update
sudo apt-get install -y kubectl
</code></pre></div></div><div id=kubectl-install-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-install-1><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#b44>&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style=color:#b44>[kubernetes]
</span><span style=color:#b44>name=Kubernetes
</span><span style=color:#b44>baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
</span><span style=color:#b44>enabled=1
</span><span style=color:#b44>gpgcheck=1
</span><span style=color:#b44>repo_gpgcheck=1
</span><span style=color:#b44>gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style=color:#b44>EOF</span>
yum install -y kubectl
</code></pre></div></div></div><h3 id=install-using-other-package-management>用其他包管理工具安装</h3><ul class="nav nav-tabs" id=other-kubectl-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#other-kubectl-install-0 role=tab aria-controls=other-kubectl-install-0 aria-selected=true>Snap</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#other-kubectl-install-1 role=tab aria-controls=other-kubectl-install-1>Homebrew</a></li></ul><div class=tab-content id=other-kubectl-install><div id=other-kubectl-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=other-kubectl-install-0><p><p>如果你使用的 Ubuntu 或其他 Linux 发行版，内建支持 <a href=https://snapcraft.io/docs/core/install>snap</a> 包管理工具，
则可用 <a href=https://snapcraft.io/>snap</a> 命令安装 kubectl。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>snap install kubectl --classic
kubectl version --client
</code></pre></div></div><div id=other-kubectl-install-1 class=tab-pane role=tabpanel aria-labelledby=other-kubectl-install-1><p><p>如果你使用 Linux 系统，并且装了 <a href=https://docs.brew.sh/Homebrew-on-Linux>Homebrew</a> 包管理工具，
则可以使用这种方式<a href=https://docs.brew.sh/Homebrew-on-Linux#install>安装</a> kubectl。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>brew install kubectl
kubectl version --client
</code></pre></div></div></div><h3 id=install-on-linux-as-part-of-the-google-cloud-sdk>作为谷歌云 SDK 的一部分，在 Linux 上安装</h3><p>kubectl 可以作为 Google Cloud SDK 的一部分被安装。</p><ol><li><p>安装 <a href=https://cloud.google.com/sdk/>Google Cloud SDK</a>。</p></li><li><p>运行安装 <code>kubectl</code> 的命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud components install kubectl
</code></pre></div></li><li><p>验证一下，确保安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl version --client
</code></pre></div></li></ol><h2 id=verify-kubectl-configration>验证 kubectl 配置</h2><p>为了让 kubectl 能发现并访问 Kubernetes 集群，你需要一个
<a href=/docs/zh/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig 文件</a>，
该文件在
<a href=https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh>kube-up.sh</a>
创建集群时，或成功部署一个 Miniube 集群时，均会自动生成。
通常，kubectl 的配置信息存放于文件 <code>~/.kube/config</code> 中。</p><p>通过获取集群状态的方法，检查是否已恰当的配置了 kubectl：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info
</code></pre></div><p>如果返回一个 URL，则意味着 kubectl 成功的访问到了你的集群。</p><p>如果你看到如下所示的消息，则代表 kubectl 配置出了问题，或无法连接到 Kubernetes 集群。</p><pre><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
（访问 &lt;server-name:port&gt; 被拒绝 - 你指定的主机和端口是否有误？）
</code></pre><p>例如，如果你想在自己的笔记本上（本地）运行 Kubernetes 集群，你需要先安装一个 Minikube 这样的工具，然后再重新运行上面的命令。</p><p>如果命令 <code>kubectl cluster-info</code> 返回了 url，但你还不能访问集群，那可以用以下命令来检查配置是否妥当：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info dump
</code></pre></div><h2 id=optional-kubectl-configurations>kubectl 的可选配置</h2><h3 id=enable-shell-autocompletion>启用 shell 自动补全功能</h3><p>kubectl 为 Bash 和 Zsh 提供自动补全功能，可以减轻许多输入的负担。</p><p>下面是为 Bash 和 Zsh 设置自动补全功能的操作步骤。</p><ul class="nav nav-tabs" id=kubectl-autocompletion role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-autocompletion-0 role=tab aria-controls=kubectl-autocompletion-0 aria-selected=true>Bash</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-autocompletion-1 role=tab aria-controls=kubectl-autocompletion-1>Zsh</a></li></ul><div class=tab-content id=kubectl-autocompletion><div id=kubectl-autocompletion-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-autocompletion-0><p><h3 id=introduction>简介</h3><p>kubectl 的 Bash 补全脚本可以用命令 <code>kubectl completion bash</code> 生成。
在 shell 中导入（Sourcing）补全脚本，将启用 kubectl 自动补全功能。</p><p>然而，补全脚本依赖于工具 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a>，
所以要先安装它（可以用命令 <code>type _init_completion</code> 检查 bash-completion 是否已安装）。</p><h3 id=install-bash-comletion>安装 bash-completion</h3><p>很多包管理工具均支持 bash-completion（参见<a href=https://github.com/scop/bash-completion#installation>这里</a>）。
可以通过 <code>apt-get install bash-completion</code> 或 <code>yum install bash-completion</code> 等命令来安装它。</p><p>上述命令将创建文件 <code>/usr/share/bash-completion/bash_completion</code>，它是 bash-completion 的主脚本。
依据包管理工具的实际情况，你需要在 <code>~/.bashrc</code> 文件中手工导入此文件。</p><p>要查看结果，请重新加载你的 shell，并运行命令 <code>type _init_completion</code>。
如果命令执行成功，则设置完成，否则将下面内容添加到文件 <code>~/.bashrc</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>source</span> /usr/share/bash-completion/bash_completion
</code></pre></div><p>重新加载 shell，再输入命令 <code>type _init_completion</code> 来验证 bash-completion 的安装状态。</p><h3 id=enable-kubectl-autocompletion>启动 kubectl 自动补全功能</h3><p>你现在需要确保一点：kubectl 补全脚本已经导入（sourced）到 shell 会话中。
这里有两种验证方法：</p><ul><li><p>在文件 <code>~/.bashrc</code> 中导入（source）补全脚本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div></li></ul><ul><li><p>将补全脚本添加到目录 <code>/etc/bash_completion.d</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><p>如果 kubectl 有关联的别名，你可以扩展 shell 补全来适配此别名：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bashrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>bash-completion 负责导入 <code>/etc/bash_completion.d</code> 目录中的所有补全脚本。</div></blockquote><p>两种方式的效果相同。重新加载 shell 后，kubectl 自动补全功能即可生效。</p></div><div id=kubectl-autocompletion-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-autocompletion-1><p><p>kubectl 通过命令 <code>kubectl completion zsh</code> 生成 Zsh 自动补全脚本。
在 shell 中导入（Sourcing）该自动补全脚本，将启动 kubectl 自动补全功能。</p><p>为了在所有的 shell 会话中实现此功能，请将下面内容加入到文件 <code>~/.zshrc</code> 中。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>
</code></pre></div><p>如果你为 kubectl 定义了别名，可以扩展脚本补全，以兼容该别名。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.zshrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.zshrc
</code></pre></div><p>重新加载 shell 后，kubectl 自动补全功能将立即生效。</p><p>如果你收到 <code>complete:13: command not found: compdef</code> 这样的错误提示，那请将下面内容添加到 <code>~/.zshrc</code> 文件的开头：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>autoload -Uz compinit
compinit
</code></pre></div></div></div><h2 id=接下来>接下来</h2><ul><li><a href=https://minikube.sigs.k8s.io/docs/start/>安装 Minikube</a></li><li>有关创建集群的更多信息，请参阅<a href=/zh/docs/setup/>入门指南</a>.</li><li><a href=/zh/docs/tasks/access-application-cluster/service-access-application-cluster/>学习如何启动并对外公开你的应用程序。</a></li><li>如果你需要访问其他人创建的集群，请参阅
<a href=/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>共享集群接入文档</a>.</li><li>阅读 <a href=/zh/docs/reference/kubectl/kubectl/>kubectl 参考文档</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-961fc70b732cb8df4fd11a3463b6545c>2 - 在 macOS 系统上安装和设置 kubectl</h1><h2 id=准备开始>准备开始</h2><p>kubectl 版本和集群之间的差异必须在一个小版本号之内。
例如：v1.2 版本的客户端只能与 v1.1、v1.2 和 v1.3 版本的集群一起工作。
用最新版本的 kubectl 有助于避免不可预见的问题。</p><h2 id=install-kubectl-on-macos>在 macOS 系统上安装 kubectl</h2><p>在 macOS 系统上安装 kubectl 有如下方法：</p><ul><li><a href=#%E5%87%86%E5%A4%87%E5%BC%80%E5%A7%8B>准备开始</a></li><li><a href=#install-kubectl-on-macos>在 macOS 系统上安装 kubectl</a><ul><li><a href=#install-kubectl-binary-with-curl-on-macos>用 curl 在 macOS 系统上安装 kubectl</a></li><li><a href=#install-with-homebrew-on-macos>用 Homebrew 在 macOS 系统上安装</a></li><li><a href=#install-with-macports-on-macos>用 Macports 在 macOS 上安装</a></li><li><a href=#install-on-macos-as-part-of-the-google-cloud-sdk>作为谷歌云 SDK 的一部分，在 macOS 上安装</a></li></ul></li><li><a href=#verify-kubectl-configuration>验证 kubectl 配置</a></li><li><a href=#optional-kubectl-configurations>可选的 kubectl 配置</a><ul><li><a href=#enable-shell-autocompletion>启用 shell 自动补全功能</a></li></ul></li><li><a href=#%E6%8E%A5%E4%B8%8B%E6%9D%A5>接下来</a></li></ul><h3 id=install-kubectl-binary-with-curl-on-macos>用 curl 在 macOS 系统上安装 kubectl</h3><ol><li><p>下载最新的发行版：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/release/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/darwin/amd64/kubectl&#34;</span>
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>如果需要下载某个指定的版本，用该指定版本号替换掉命令的这个部分：<code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>。
例如：要在 macOS 系统中下载 v1.20.15 版本，则输入：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO https://dl.k8s.io/release/v1.20.15/bin/darwin/amd64/kubectl
</code></pre></div></div></blockquote></li><li><p>验证可执行文件（可选操作）</p><p>下载 kubectl 的校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/darwin/amd64/kubectl.sha256&#34;</span>
</code></pre></div><p>根据校验和文件，验证 kubectl：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>&lt;kubectl.sha256<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>  kubectl&#34;</span> | shasum -a <span style=color:#666>256</span> --check
</code></pre></div><p>验证通过时，输出如下：</p><pre><code class=language-console data-lang=console>kubectl: OK
</code></pre><p>验证失败时，<code>shasum</code> 将以非零值退出，并打印如下输出：</p><pre><code>kubectl: FAILED
shasum: WARNING: 1 computed checksum did NOT match
</code></pre><blockquote class="note callout"><div><strong>说明：</strong><p>下载的 kubectl 与校验和文件版本要相同。</div></blockquote></li><li><p>将 kubectl 置为可执行文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chmod +x ./kubectl
</code></pre></div></li><li><p>将可执行文件 kubectl 移动到系统可寻址路径 <code>PATH</code> 内的一个位置：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo mv ./kubectl /usr/local/bin/kubectl
sudo chown root: /usr/local/bin/kubectl
</code></pre></div></li><li><p>测试一下，确保你安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=install-with-homebrew-on-macos>用 Homebrew 在 macOS 系统上安装</h3><p>如果你是 macOS 系统，且用的是 <a href=https://brew.sh/>Homebrew</a> 包管理工具，
则可以用 Homebrew 安装 kubectl。</p><ol><li><p>运行安装命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install kubectl 
</code></pre></div><p>或</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install kubernetes-cli
</code></pre></div></li><li><p>测试一下，确保你安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=install-with-macports-on-macos>用 Macports 在 macOS 上安装</h3><p>如果你用的是 macOS，且用 <a href=https://macports.org/>Macports</a> 包管理工具，则你可以用 Macports 安装kubectl。</p><ol><li><p>运行安装命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo port selfupdate
sudo port install kubectl
</code></pre></div></li><li><p>测试一下，确保你安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=install-on-macos-as-part-of-the-google-cloud-sdk>作为谷歌云 SDK 的一部分，在 macOS 上安装</h3><p>kubectl 可以作为 Google Cloud SDK 的一部分被安装。</p><ol><li><p>安装 <a href=https://cloud.google.com/sdk/>Google Cloud SDK</a>。</p></li><li><p>运行安装 <code>kubectl</code> 的命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud components install kubectl
</code></pre></div></li><li><p>验证一下，确保安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl version --client
</code></pre></div></li></ol><h2 id=verify-kubectl-configuration>验证 kubectl 配置</h2><p>为了让 kubectl 能发现并访问 Kubernetes 集群，你需要一个
<a href=/docs/zh/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig 文件</a>，
该文件在
<a href=https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh>kube-up.sh</a>
创建集群时，或成功部署一个 Miniube 集群时，均会自动生成。
通常，kubectl 的配置信息存放于文件 <code>~/.kube/config</code> 中。</p><p>通过获取集群状态的方法，检查是否已恰当的配置了 kubectl：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info
</code></pre></div><p>如果返回一个 URL，则意味着 kubectl 成功的访问到了你的集群。</p><p>如果你看到如下所示的消息，则代表 kubectl 配置出了问题，或无法连接到 Kubernetes 集群。</p><pre><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
（访问 &lt;server-name:port&gt; 被拒绝 - 你指定的主机和端口是否有误？）
</code></pre><p>例如，如果你想在自己的笔记本上（本地）运行 Kubernetes 集群，你需要先安装一个 Minikube 这样的工具，然后再重新运行上面的命令。</p><p>如果命令 <code>kubectl cluster-info</code> 返回了 url，但你还不能访问集群，那可以用以下命令来检查配置是否妥当：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info dump
</code></pre></div><h2 id=optional-kubectl-configurations>可选的 kubectl 配置</h2><h3 id=enable-shell-autocompletion>启用 shell 自动补全功能</h3><p>kubectl 为 Bash 和 Zsh 提供自动补全功能，这可以节省许多输入的麻烦。</p><p>下面是为 Bash 和 Zsh 设置自动补全功能的操作步骤。</p><ul class="nav nav-tabs" id=kubectl-autocompletion role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-autocompletion-0 role=tab aria-controls=kubectl-autocompletion-0 aria-selected=true>Bash</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-autocompletion-1 role=tab aria-controls=kubectl-autocompletion-1>Zsh</a></li></ul><div class=tab-content id=kubectl-autocompletion><div id=kubectl-autocompletion-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-autocompletion-0><p><h3 id=简介>简介</h3><p>kubectl 的 Bash 补全脚本可以通过 <code>kubectl completion bash</code> 命令生成。
在你的 shell 中导入（Sourcing）这个脚本即可启用补全功能。</p><p>此外，kubectl 补全脚本依赖于工具 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a>，
所以你必须先安装它。</p><blockquote class="warning callout"><div><strong>警告：</strong><p>bash-completion 有两个版本：v1 和 v2。v1 对应 Bash3.2（也是 macOS 的默认安装版本），v2 对应 Bash 4.1+。
kubectl 的补全脚本<strong>无法适配</strong> bash-completion v1 和 Bash 3.2。
必须为它配备 <strong>bash-completion v2</strong> 和 <strong>Bash 4.1+</strong>。
有鉴于此，为了在 macOS 上使用 kubectl 补全功能，你必须要安装和使用 Bash 4.1+
(<a href=https://itnext.io/upgrading-bash-on-macos-7138bd1066ba><em>说明</em></a>)。
后续说明假定你用的是 Bash 4.1+（也就是 Bash 4.1 或更新的版本）</div></blockquote><h3 id=升级-bash>升级 Bash</h3><p>后续说明假定你已使用 Bash 4.1+。你可以运行以下命令检查 Bash 版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span>
</code></pre></div><p>如果版本太旧，可以用 Homebrew 安装/升级：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash
</code></pre></div><p>重新加载 shell，并验证所需的版本已经生效：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span> <span style=color:#b8860b>$SHELL</span>
</code></pre></div><p>Homebrew 通常把它安装为 <code>/usr/local/bin/bash</code>。</p><h3 id=安装-bash-completion>安装 bash-completion</h3><blockquote class="note callout"><div><strong>说明：</strong><p>如前所述，本说明假定你使用的 Bash 版本为 4.1+，这意味着你要安装 bash-completion v2
（不同于 Bash 3.2 和 bash-completion v1，kubectl 的补全功能在该场景下无法工作）。</div></blockquote><p>你可以用命令 <code>type _init_completion</code> 测试 bash-completion v2 是否已经安装。
如未安装，用 Homebrew 来安装它：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash-completion@2
</code></pre></div><p>如命令的输出信息所显示的，将如下内容添加到文件 <code>~/.bash_profile</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>export</span> <span style=color:#b8860b>BASH_COMPLETION_COMPAT_DIR</span><span style=color:#666>=</span><span style=color:#b44>&#34;/usr/local/etc/bash_completion.d&#34;</span>
<span style=color:#666>[[</span> -r <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span> <span style=color:#666>]]</span> <span style=color:#666>&amp;&amp;</span> . <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span>
</code></pre></div><p>重新加载 shell，并用命令 <code>type _init_completion</code> 验证 bash-completion v2 已经恰当的安装。</p><h3 id=启用-kubectl-自动补全功能>启用 kubectl 自动补全功能</h3><p>你现在需要确保在所有的 shell 环境中均已导入（sourced） kubectl 的补全脚本，
有若干种方法可以实现这一点：</p><ul><li><p>在文件 <code>~/.bash_profile</code> 中导入（Source）补全脚本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li><p>将补全脚本添加到目录 <code>/usr/local/etc/bash_completion.d</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/usr/local/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><ul><li><p>如果你为 kubectl 定义了别名，则可以扩展 shell 补全来兼容该别名：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bash_profile
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li><p>如果你是用 Homebrew 安装的 kubectl（<a href=#install-with-homebrew-on-macos>如上所述</a>），
那么 kubectl 补全脚本应该已经安装到目录 <code>/usr/local/etc/bash_completion.d/kubectl</code> 中了。
这种情况下，你什么都不需要做。</p><blockquote class="note callout"><div><strong>说明：</strong><p>用 Hommbrew 安装的 bash-completion v2 会初始化 目录 <code>BASH_COMPLETION_COMPAT_DIR</code> 中的所有文件，这就是后两种方法能正常工作的原因。</div></blockquote></li></ul><p>总之，重新加载 shell 之后，kubectl 补全功能将立即生效。</p></div><div id=kubectl-autocompletion-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-autocompletion-1><p><p>kubectl 通过命令 <code>kubectl completion zsh</code> 生成 Zsh 自动补全脚本。
在 shell 中导入（Sourcing）该自动补全脚本，将启动 kubectl 自动补全功能。</p><p>为了在所有的 shell 会话中实现此功能，请将下面内容加入到文件 <code>~/.zshrc</code> 中。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>
</code></pre></div><p>如果你为 kubectl 定义了别名，可以扩展脚本补全，以兼容该别名。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.zshrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.zshrc
</code></pre></div><p>重新加载 shell 后，kubectl 自动补全功能将立即生效。</p><p>如果你收到 <code>complete:13: command not found: compdef</code> 这样的错误提示，那请将下面内容添加到 <code>~/.zshrc</code> 文件的开头：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>autoload -Uz compinit
compinit
</code></pre></div></div></div><h2 id=接下来>接下来</h2><ul><li><a href=https://minikube.sigs.k8s.io/docs/start/>安装 Minikube</a></li><li>有关创建集群的更多信息，请参阅<a href=/zh/docs/setup/>入门指南</a>.</li><li><a href=/zh/docs/tasks/access-application-cluster/service-access-application-cluster/>学习如何启动并对外公开你的应用程序。</a></li><li>如果你需要访问其他人创建的集群，请参阅
<a href=/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>共享集群接入文档</a>.</li><li>阅读 <a href=/zh/docs/reference/kubectl/kubectl/>kubectl 参考文档</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-bbdc530b292ab4074d1dfe69feafb3e7>3 - 安装并配置 kubectl</h1><p>使用 Kubernetes 命令行工具 <a href=/zh/docs/reference/kubectl/kubectl/>kubectl</a>，
你可以在 Kubernetes 上运行命令。
使用 kubectl，你可以部署应用、检视和管理集群资源、查看日志。
要了解 kubectl 操作的完整列表，请参阅
<a href=/zh/docs/reference/kubectl/overview/>kubectl 概览</a>。</p><h2 id=准备开始>准备开始</h2><p>你必须使用与集群小版本号差别为一的 kubectl 版本。
例如，1.2 版本的客户端应该与 1.1 版本、1.2 版本和 1.3 版本的主节点一起使用。
使用最新版本的 kubectl 有助于避免无法预料的问题。</p><h2 id=install-kubectl-on-linux>在 Linux 上安装 kubectl</h2><h3 id=在-linux-上使用-curl-安装-kubectl-可执行文件>在 Linux 上使用 curl 安装 kubectl 可执行文件</h3><ol><li><p>使用下面命令下载最新的发行版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/release/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/linux/amd64/kubectl&#34;</span>
</code></pre></div><p>要下载特定版本，将命令中的 <code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>
部分替换为指定版本。</p><p>例如，要下载 Linux 上的版本 v1.20.15，输入：</p><pre><code>curl -LO https://dl.k8s.io/release/v1.20.15/bin/linux/amd64/kubectl
</code></pre></li></ol><ol start=2><li><p>验证可执行文件（可选步骤）：</p><p>下载 kubectl 校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/linux/amd64/kubectl.sha256&#34;</span>
</code></pre></div><p>使用校验和文件检查 kubectl 可执行二进制文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>&lt;kubectl.sha256<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44> kubectl&#34;</span> | sha256sum --check
</code></pre></div><p>如果合法，则输出为：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl: OK
</code></pre></div><p>如果检查失败，则 <code>sha256</code> 退出且状态值非 0 并打印类似如下输出：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl: FAILED
sha256sum: WARNING: <span style=color:#666>1</span> computed checksum did NOT match
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>所下载的二进制可执行文件和校验和文件须是同一版本。</div></blockquote></li></ol><ol start=3><li><p>安装 kubectl</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo install -o root -g root -m <span style=color:#666>0755</span> kubectl /usr/local/bin/kubectl
</code></pre></div><p>如果你并不拥有目标系统的 root 访问权限，你仍可以将 kubectl 安装到
<code>~/.local/bin</code> 目录下：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p ~/.local/bin/kubectl
mv ./kubectl ~/.local/bin/kubectl
<span style=color:#080;font-style:italic># 之后将 ~/.local/bin/kubectl 添加到环境变量 $PATH 中</span>
</code></pre></div></li></ol><ol start=4><li><p>测试你所安装的版本是最新的：</p><pre><code>kubectl version --client
</code></pre></li></ol><h3 id=install-using-native-package-management>使用原生包管理器安装</h3><ul class="nav nav-tabs" id=kubectl-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-install-0 role=tab aria-controls=kubectl-install-0 aria-selected=true>Ubuntu、Debian 或 HypriotOS</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-install-1 role=tab aria-controls=kubectl-install-1>CentOS、RHEL 或 Fedora</a></li></ul><div class=tab-content id=kubectl-install><div id=kubectl-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-install-0><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
sudo apt-get update <span style=color:#666>&amp;&amp;</span> sudo apt-get install -y apt-transport-https gnupg2 curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
<span style=color:#a2f>echo</span> <span style=color:#b44>&#34;deb https://apt.kubernetes.io/ kubernetes-xenial main&#34;</span> | sudo tee -a /etc/apt/sources.list.d/kubernetes.list
sudo apt-get update
sudo apt-get install -y kubectl
</code></pre></div></div><div id=kubectl-install-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-install-1><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
cat <span style=color:#b44>&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style=color:#b44>[kubernetes]
</span><span style=color:#b44>name=Kubernetes
</span><span style=color:#b44>baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
</span><span style=color:#b44>enabled=1
</span><span style=color:#b44>gpgcheck=1
</span><span style=color:#b44>repo_gpgcheck=1
</span><span style=color:#b44>gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style=color:#b44>EOF</span>
yum install -y kubectl
</code></pre></div></div></div><h3 id=install-using-other-package-management>使用其他包管理器安装</h3><ul class="nav nav-tabs" id=other-kubectl-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#other-kubectl-install-0 role=tab aria-controls=other-kubectl-install-0 aria-selected=true>Snap</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#other-kubectl-install-1 role=tab aria-controls=other-kubectl-install-1>Homebrew</a></li></ul><div class=tab-content id=other-kubectl-install><div id=other-kubectl-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=other-kubectl-install-0><p><p>如果你使用 Ubuntu 或者其他支持 <a href=https://snapcraft.io/docs/core/install>snap</a>
包管理器的 Linux 发行版，kubeclt 可以作为 <a href=https://snapcraft.io>Snap</a>
应用来安装：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>snap install kubectl --classic

kubectl version --client
</code></pre></div></div><div id=other-kubectl-install-1 class=tab-pane role=tabpanel aria-labelledby=other-kubectl-install-1><p><p>如果你在使用 Linux 且使用 <a href=https://docs.brew.sh/Homebrew-on-Linux>Homebrew</a> 包管理器，
kubectl 也可以用这种方式<a href=https://docs.brew.sh/Homebrew-on-Linux#install>安装</a>。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>brew install kubectl

kubectl version --client
</code></pre></div></div></div><h2 id=在-macos-上安装-kubectl>在 macOS 上安装 kubectl</h2><h3 id=在-macos-上使用-curl-安装-kubectl-可执行文件>在 macOS 上使用 curl 安装 kubectl 可执行文件</h3><ol><li><p>下载最新发行版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/release/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/darwin/amd64/kubectl&#34;</span>
</code></pre></div><p>要下载特定版本，可将上面命令中的 <code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>
部分替换成你想要的版本。</p><p>例如，要在 macOS 上安装版本 v1.20.15，输入：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO https://dl.k8s.io/release/v1.20.15/bin/darwin/amd64/kubectl
</code></pre></div></li></ol><ol start=2><li><p>检查二进制可执行文件（可选操作）</p><p>下载 kubectl 校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO <span style=color:#b44>&#34;https://dl.k8s.io/</span><span style=color:#a2f;font-weight:700>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>/bin/darwin/amd64/kubectl.sha256&#34;</span>
</code></pre></div><p>使用校验和文件检查 kubectl 二进制可执行文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>&lt;kubectl.sha256<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>  kubectl&#34;</span> | shasum -a <span style=color:#666>256</span> --check
</code></pre></div><p>如果合法，则输出为：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl: OK
</code></pre></div><p>如果检查失败，则 <code>shasum</code> 退出且状态值为非 0，并打印类似如下的输出：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl: FAILED
shasum: WARNING: <span style=color:#666>1</span> computed checksum did NOT match
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>下载的二进制可执行文件和校验和文件须为同一版本。</div></blockquote></li></ol><ol start=3><li><p>设置 kubectl 二进制文件为可执行模式</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chmod +x ./kubectl
</code></pre></div></li></ol><ol start=4><li><p>将 kubectl 二进制文件移动到系统 <code>PATH</code> 环境变量中的某个位置：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo mv ./kubectl /usr/local/bin/kubectl <span style=color:#666>&amp;&amp;</span> <span style=color:#b62;font-weight:700>\
</span><span style=color:#b62;font-weight:700></span>sudo chown root: /usr/local/bin/kubectl
</code></pre></div></li></ol><ol start=5><li><p>测试以确保所安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=install-with-homebrew-on-macos>在 macOS 上使用 Homebrew 安装</h3><p>如果你使用的是 macOS 系统且使用 <a href=https://brew.sh/>Homebrew</a> 包管理器，
你可以使用 Homebrew 来安装 kubectl。</p><ol><li><p>运行安装命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install kubectl 
</code></pre></div><p>或者</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install kubernetes-cli
</code></pre></div></li></ol><ol start=2><li><p>测试以确保你安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h3 id=在-macos-上用-macports-安装-kubectl>在 macOS 上用 Macports 安装 kubectl</h3><p>如果你使用的是 macOS 系统并使用 <a href=https://macports.org/>Macports</a> 包管理器，
你可以通过 Macports 安装 kubectl。</p><ol><li><p>运行安装命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo port selfupdate
sudo port install kubectl
</code></pre></div></li></ol><ol start=2><li><p>测试以确保你安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --client
</code></pre></div></li></ol><h2 id=install-kubectl-on-windows>在 Windows 上安装 kubectl</h2><h3 id=在-windows-上使用-curl-安装-kubectl-二进制文件>在 Windows 上使用 curl 安装 kubectl 二进制文件</h3><ol><li><p>下载<a href=https://dl.k8s.io/release/v1.20.15/bin/windows/amd64/kubectl.exe>最新发行版本 v1.20.15</a>。</p><p>或者如何你安装了 <code>curl</code>，使用下面的命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -LO https://dl.k8s.io/release/v1.20.15/bin/windows/amd64/kubectl.exe
</code></pre></div><p>要了解哪个是最新的稳定版本（例如，出于脚本编写目的），可查看
<a href=https://dl.k8s.io/release/stable.txt>https://dl.k8s.io/release/stable.txt</a>。</p></li></ol><ol start=2><li><p>验证二进制可执行文件（可选操作）</p><p>下载 kubectl 校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#a2f>curl </span>-LO https<span>:</span>//dl.k8s.io/v1.20.15/bin/windows/amd64/kubectl.exe.sha256
</code></pre></div><p>使用校验和文件验证 kubectl 可执行二进制文件：</p><ul><li><p>使用命令行提示符（Commmand Prompt）来手动比较 <code>CertUtil</code> 的输出与
所下载的校验和文件：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd>CertUtil -hashfile kubectl.exe SHA256
<span style=color:#a2f;font-weight:700>type</span> kubectl.exe.sha256
</code></pre></div></li></ul><ul><li><p>使用 PowerShell 的 <code>-eq</code> 操作符来自动完成校验操作，获得 <code>True</code> 或 <code>False</code> 结果：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>$($(CertUtil -hashfile .\kubectl.exe SHA256)[1] <span style=color:#666>-replace</span> <span style=color:#b44>&#34; &#34;</span>, <span style=color:#b44>&#34;&#34;</span>) <span style=color:#666>-eq</span> $(<span style=color:#a2f>type </span>.\kubectl.exe.sha256)
</code></pre></div></li></ul></li></ol><ol start=3><li>将可执行文件放到 PATH 目录下。</li></ol><ol start=4><li><p>测试以确定所下载的 <code>kubectl</code> 版本是正确的的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd>kubectl version --client
</code></pre></div></li></ol><blockquote class="note callout"><div><strong>说明：</strong> <a href=https://docs.docker.com/docker-for-windows/#kubernetes>Docker Desktop for Windows</a>
会将自己的 <code>kubectl</code> 程序添加到 PATH 中。
如果你之前安装过 Docker Desktop，你可能需要将新安装的 PATH 项放到 Docker Desktop
安装程序所添加的目录之前，或者干脆删除 Docker Desktop 所安装的 <code>kubectl</code>。</div></blockquote><h2 id=使用-powershell-从-psgallery-安装-kubectl>使用 PowerShell 从 PSGallery 安装 kubectl</h2><p>如果你使用的是 Windows 系统并使用 <a href=https://www.powershellgallery.com/>Powershell Gallery</a>
软件包管理器，你可以使用 PowerShell 安装和更新 kubectl。</p><ol><li><p>运行安装命令（确保指定 <code>DownloadLocation</code>）：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#a2f>Install-Script</span> -Name <span style=color:#b44>&#39;install-kubectl&#39;</span> -Scope CurrentUser -Force
<span style=color:#a2f>install-kubectl</span>.ps1 [-DownloadLocation &lt;路径名&gt;]
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong> 如果你没有指定 <code>DownloadLocation</code>，那么 <code>kubectl</code> 将安装在用户的 <code>temp</code> 目录中。</div></blockquote><p>安装程序创建 <code>$HOME/.kube</code> 目录，并指示它创建配置文件</p></li></ol><ol start=2><li><p>测试以确保你安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>kubectl version --client
</code></pre></div></li></ol><blockquote class="note callout"><div><strong>说明：</strong> 通过重新运行步骤 1 中列出的两个命令可以更新安装。</div></blockquote><h3 id=在-windows-系统上用-chocolatey-或者-scoop-安装>在 Windows 系统上用 Chocolatey 或者 Scoop 安装</h3><ol><li><p>要在 Windows 上用 <a href=https://chocolatey.org>Chocolatey</a> 或者
<a href=https://scoop.sh>Scoop</a> 命令行安装程序安装 kubectl：</p><ul class="nav nav-tabs" id=kubectl-win-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-win-install-0 role=tab aria-controls=kubectl-win-install-0 aria-selected=true>choco</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-win-install-1 role=tab aria-controls=kubectl-win-install-1>scoop</a></li></ul><div class=tab-content id=kubectl-win-install><div id=kubectl-win-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-win-install-0><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>choco install kubernetes-cli
</code></pre></div></div><div id=kubectl-win-install-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-win-install-1><p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>scoop install kubectl
</code></pre></div></div></div></li></ol><ol start=2><li><p>测试以确保你安装的版本是最新的：</p><pre><code>kubectl version --client
</code></pre></li></ol><ol start=3><li><p>切换到你的 HOME 目录：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#080;font-style:italic># 如果你在使用 cmd.exe，运行 cd %USERPROFILE%</span>
<span style=color:#a2f>cd </span>~
</code></pre></div></li></ol><ol start=4><li><p>创建 <code>.kube</code> 目录：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>mkdir .kube
</code></pre></div></li></ol><ol start=5><li><p>进入到刚刚创建的 <code>.kube</code> 目录：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#a2f>cd </span>.kube
</code></pre></div></li></ol><ol start=6><li><p>配置 kubectl 以使用远程 Kubernetes 集群：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#a2f>New-Item</span> config -type file
</code></pre></div></li></ol><blockquote class="note callout"><div><strong>说明：</strong> 使用你喜欢的文本编辑器，例如 Notepad，编辑此配置文件。</div></blockquote><h2 id=将-kubectl-作为-google-cloud-sdk-的一部分下载>将 kubectl 作为 Google Cloud SDK 的一部分下载</h2><p>kubectl 可以作为 Google Cloud SDK 的一部分进行安装。</p><ol><li><p>安装 <a href=https://cloud.google.com/sdk/>Google Cloud SDK</a>。</p></li><li><p>运行以下命令安装 <code>kubectl</code>：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud components install kubectl
</code></pre></div></li></ol><ol start=3><li><p>测试以确保你安装的版本是最新的：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl version --client
</code></pre></div></li></ol><h2 id=verifying-kubectl-configuration>验证 kubectl 配置</h2><p>kubectl 需要一个
<a href=/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig 配置文件</a>
使其找到并访问 Kubernetes 集群。当你使用
<a href=https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh>kube-up.sh</a>
创建 Kubernetes 集群或者使用已经部署好的 Minikube 集群时，
会自动生成 kubeconfig 配置文件。
默认情况下，kubectl 的配置文件位于 <code>~/.kube/config</code>。</p><p>通过获取集群状态检查 kubectl 是否被正确配置：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info
</code></pre></div><p>如果你看到一个 URL 被返回，那么 kubectl 已经被正确配置，
能够正常访问你的 Kubernetes 集群。</p><p>如果你看到类似以下的信息被返回，那么 kubectl 没有被正确配置，
无法正常访问你的 Kubernetes 集群。</p><pre><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
</code></pre><p>例如，如果你打算在笔记本电脑（本地）上运行 Kubernetes 集群，则需要首先安装
minikube 等工具，然后重新运行上述命令。</p><p>如果 kubectl cluster-info 能够返回 URL 响应，但你无法访问你的集群，可以使用
下面的命令检查配置是否正确：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info dump
</code></pre></div><h2 id=可选的-kubectl-配置>可选的 kubectl 配置</h2><h3 id=启用-shell-自动补全功能>启用 shell 自动补全功能</h3><p>kubectl 为 Bash 和 Zsh 支持自动补全功能，可以节省大量输入！</p><p>下面是设置 Bash 与 Zsh 下自动补齐的过程（包括 Linux 与 macOS 的差异）。</p><ul class="nav nav-tabs" id=kubectl-autocompletion role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kubectl-autocompletion-0 role=tab aria-controls=kubectl-autocompletion-0 aria-selected=true>Linux 上的 Bash</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-autocompletion-1 role=tab aria-controls=kubectl-autocompletion-1>macOS 上的 Bash</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kubectl-autocompletion-2 role=tab aria-controls=kubectl-autocompletion-2>Zsh</a></li></ul><div class=tab-content id=kubectl-autocompletion><div id=kubectl-autocompletion-0 class="tab-pane show active" role=tabpanel aria-labelledby=kubectl-autocompletion-0><p><h4 id=介绍>介绍</h4><p>用于 Bash 的 kubectl 自动补齐脚本可以用 <code>kubectl completion bash</code> 命令生成。
在 Shell 环境中引用自动补齐脚本就可以启用 kubectl 自动补齐。</p><p>不过，补齐脚本依赖于 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a> 软件包，
这意味着你必须先安装 bash-completion（你可以通过运行 <code>type _init_completion</code>）来测试是否
你已经安装了这个软件）。</p><h3 id=安装-bash-completion>安装 bash-completion</h3><p>很多包管理器都提供 bash-completion（参见<a href=https://github.com/scop/bash-completion#installation>这里</a>）。
你可以通过 <code>apt-get install bash-completion</code> 或 <code>yum install bash-completion</code> 来安装。</p><p>上述命令会创建 <code>/usr/share/bash-completion/bash_completion</code>，也就是 bash-completion 的主脚本。
取决于所用的包管理器，你可能必须在你的 <code>~/.bashrc</code> 中通过 <code>source</code> 源引此文件。</p><p>要搞清楚这一点，可以重新加载你的 Shell 并运行 <code>type _init_completion</code>。
如果命令成功，一切就绪；否则你就需要将下面的内容添加到你的 <code>~/.bashrc</code>
文件中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>source</span> /usr/share/bash-completion/bash_completion
</code></pre></div><p>之后，重新加载你的 Shell 并运行 <code>type _init_completion</code> 来检查 bash-completion 是否已
正确安装。</p><h3 id=启用-kubectl-自动补齐>启用 kubectl 自动补齐</h3><p>你现在需要确定在你的所有 Shell 会话中都源引了 kubectl 自动补齐脚本。
实现这点有两种方式：</p><ul><li><p>在 <code>~/.bashrc</code> 文件中源引自动补齐脚本</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div></li></ul><ul><li><p>将自动补齐脚本添加到目录 <code>/etc/bash_completion.d</code>：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><p>如果你为 kubectl 命令设置了别名（alias），你可以扩展 Shell 补齐，使之能够与别名一起使用：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bashrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong> bash-completion 会自动源引 <code>/etc/bash_completion.d</code> 下的所有自动补齐脚本。</div></blockquote><p>两种方法是等价的。重新加载 Shell 之后，kubectl 的自动补齐应该能够使用了。</p></div><div id=kubectl-autocompletion-1 class=tab-pane role=tabpanel aria-labelledby=kubectl-autocompletion-1><p><h3 id=介绍>介绍</h3><p>用于 Bash 的 kubectl 自动补齐脚本可以用 <code>kubectl completion bash</code> 命令生成。
在 Shell 环境中引用自动补齐脚本就可以启用 kubectl 自动补齐。
不过，补齐脚本依赖于 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a> 软件包，
你必须预先安装。</p><blockquote class="warning callout"><div><strong>警告：</strong> <code>bash-completion</code> 有两个版本，v1 和 v2。
v1 是用于 Bash 3.2 版本的（macOS 上的默认配置），v2 是用于 Bash 4.1 以上版本的。
<code>kubectl</code> 补齐脚本 <em>无法</em> 在 v1 版本的 bash-completion 和 Bash 3.2 上使用，
需要 <strong>bash-completion v2</strong> 和 <strong>Bash 4.1 以上版本</strong>。
因此，为了在 macOS 上正常使用 kubectl 自动补齐，你需要安装并使用 Bash 4.1+
版本（<a href=https://itnext.io/upgrading-bash-on-macos-7138bd1066ba><em>相关指南</em></a>）。
下面的指令假定你在使用 Bash 4.1+（也就是说 Bash 4.1 及以上版本）。</div></blockquote><h3 id=upgrade-bash>升级 Bash</h3><p>这里的命令假定你使用的是 Bash 4.1+。你可以通过下面的命令来检查 Bash 版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span>
</code></pre></div><p>如果版本很老，你可以使用 Homebrew 来安装或升级：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash
</code></pre></div><p>重新加载 Shell 并验证你使用的版本是期望的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span> <span style=color:#b8860b>$SHELL</span>
</code></pre></div><p>Homebrew 通常安装 Bash 到 <code>/usr/local/bin/bash</code>。</p><h3 id=安装-bash-completion>安装 bash-completion</h3><blockquote class="note callout"><div><strong>说明：</strong> 如前所述，这里的指令假定你使用的是 Bash 4.1+，这意味着你会安装 bash-completion
的 v2 版本（与此相对，在 Bash 3.2 版本中的 bash-completion v1 是 kubectl
无法使用的。</div></blockquote><p>你可以通过输入 <code>type _init_completion</code> 来测试是否 bash-completion v2 已经安装。
如果没有，可以用 Homebrew 来安装：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash-completion@2
</code></pre></div><p>就像命令的输出所提示的，你应该将下面的内容添加到 <code>~/.bash_profile</code> 文件中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>export</span> <span style=color:#b8860b>BASH_COMPLETION_COMPAT_DIR</span><span style=color:#666>=</span><span style=color:#b44>&#34;/usr/local/etc/bash_completion.d&#34;</span>
<span style=color:#666>[[</span> -r <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span> <span style=color:#666>]]</span> <span style=color:#666>&amp;&amp;</span> . <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span>
</code></pre></div><p>重新加载你的 Shell 并运行 <code>type _init_completion</code>，验证 bash-completion v2
被正确安装。</p><h3 id=启用-kubectl-自动补齐>启用 kubectl 自动补齐</h3><p>你现在需要确保在你的所有 Shell 会话中都源引了 kubectl 自动补齐脚本。
实现这点有两种方式：</p><ul><li><p>在 <code>~/.bash_profile</code> 文件中源引自动补齐脚本</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li><p>将自动补齐脚本添加到目录 <code>/usr/local/etc/bash_completion.d</code>：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/usr/local/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><ul><li><p>如果你为 kubectl 命令设置了别名（alias），你可以扩展 Shell 补齐，使之能够与别名一起使用：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bash_profile
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li>如果你是所有 Homebrew 来安装 kubectl（如<a href=#install-with-homebrew-on-macos>前文</a>所述）,
kubectl 补齐脚本应该已经位于 <code>/usr/local/etc/bash_completion.d/kubectl</code> 目录下。
在这种情况下，你就不用做任何操作了。</li></ul><blockquote class="note callout"><div><strong>说明：</strong> Homebrew 安装 bash-completion v2 时会源引 <code>BASH_COMPLETION_COMPAT_DIR</code> 目录下的所有
文件，这是为什么后面两种方法也可行的原因。</div></blockquote><p>在任何一种情况下，重新加载 Shell 之后，kubectl 的自动补齐应该可以工作了。</p></div><div id=kubectl-autocompletion-2 class=tab-pane role=tabpanel aria-labelledby=kubectl-autocompletion-2><p><p>Zsh 的 kubectl 补齐脚本可通过 <code>kubectl completion zsh</code> 命令来生成。
在 Shell 环境中引用自动补齐脚本就可以启用 kubectl 自动补齐。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>
</code></pre></div><p>如果你为 kubectl 命令设置了别名（alias），你可以扩展 Shell 补齐，使之能够与别名一起使用：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.zshrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.zshrc
</code></pre></div><p>重新加载 Shell 之后，kubectl 的自动补齐应该可以工作了。</p><p>如果你看到类似 <code>complete:13: command not found: compdef</code> 这种错误信息，
可以将下面的命令添加到你的 <code>~/.zshrc</code> 文件的文件头：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>autoload -Uz compinit
compinit
</code></pre></div></div></div><h2 id=接下来>接下来</h2><ul><li><a href=https://minikube.sigs.k8s.io/docs/start/>安装 Minikube</a></li><li>参阅<a href=/zh/docs/setup/>入门指南</a>，了解创建集群相关的信息</li><li>了解如何<a href=/zh/docs/tasks/access-application-cluster/service-access-application-cluster/>启动和暴露你的应用</a></li><li>如果你需要访问别人创建的集群，参考
<a href=/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>共享集群访问文档</a></li><li>阅读 <a href=/zh/docs/reference/kubectl/kubectl/>kubectl 参考文档</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-2d600cc8ec4dec69673b5f9577b6da22>4 - Linux 系统中的 bash 自动补全功能</h1><div class=lead>Linux 系统中 bash 自动补全功能的一些可选配置。</div><h3 id=introduction>简介</h3><p>kubectl 的 Bash 补全脚本可以用命令 <code>kubectl completion bash</code> 生成。
在 shell 中导入（Sourcing）补全脚本，将启用 kubectl 自动补全功能。</p><p>然而，补全脚本依赖于工具 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a>，
所以要先安装它（可以用命令 <code>type _init_completion</code> 检查 bash-completion 是否已安装）。</p><h3 id=install-bash-comletion>安装 bash-completion</h3><p>很多包管理工具均支持 bash-completion（参见<a href=https://github.com/scop/bash-completion#installation>这里</a>）。
可以通过 <code>apt-get install bash-completion</code> 或 <code>yum install bash-completion</code> 等命令来安装它。</p><p>上述命令将创建文件 <code>/usr/share/bash-completion/bash_completion</code>，它是 bash-completion 的主脚本。
依据包管理工具的实际情况，你需要在 <code>~/.bashrc</code> 文件中手工导入此文件。</p><p>要查看结果，请重新加载你的 shell，并运行命令 <code>type _init_completion</code>。
如果命令执行成功，则设置完成，否则将下面内容添加到文件 <code>~/.bashrc</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>source</span> /usr/share/bash-completion/bash_completion
</code></pre></div><p>重新加载 shell，再输入命令 <code>type _init_completion</code> 来验证 bash-completion 的安装状态。</p><h3 id=enable-kubectl-autocompletion>启动 kubectl 自动补全功能</h3><p>你现在需要确保一点：kubectl 补全脚本已经导入（sourced）到 shell 会话中。
这里有两种验证方法：</p><ul><li><p>在文件 <code>~/.bashrc</code> 中导入（source）补全脚本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div></li></ul><ul><li><p>将补全脚本添加到目录 <code>/etc/bash_completion.d</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><p>如果 kubectl 有关联的别名，你可以扩展 shell 补全来适配此别名：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bashrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div><blockquote class="note callout"><div><strong>说明：</strong><p>bash-completion 负责导入 <code>/etc/bash_completion.d</code> 目录中的所有补全脚本。</div></blockquote><p>两种方式的效果相同。重新加载 shell 后，kubectl 自动补全功能即可生效。</p></div><div class=td-content style=page-break-before:always><h1 id=pg-68808b3ec5807517ed64fd8ae32a7d1b>5 - macOS 系统上的 bash 自动补全</h1><div class=lead>在 macOS 上实现 Bash 自动补全的一些可选配置。</div><h3 id=简介>简介</h3><p>kubectl 的 Bash 补全脚本可以通过 <code>kubectl completion bash</code> 命令生成。
在你的 shell 中导入（Sourcing）这个脚本即可启用补全功能。</p><p>此外，kubectl 补全脚本依赖于工具 <a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a>，
所以你必须先安装它。</p><blockquote class="warning callout"><div><strong>警告：</strong><p>bash-completion 有两个版本：v1 和 v2。v1 对应 Bash3.2（也是 macOS 的默认安装版本），v2 对应 Bash 4.1+。
kubectl 的补全脚本<strong>无法适配</strong> bash-completion v1 和 Bash 3.2。
必须为它配备 <strong>bash-completion v2</strong> 和 <strong>Bash 4.1+</strong>。
有鉴于此，为了在 macOS 上使用 kubectl 补全功能，你必须要安装和使用 Bash 4.1+
(<a href=https://itnext.io/upgrading-bash-on-macos-7138bd1066ba><em>说明</em></a>)。
后续说明假定你用的是 Bash 4.1+（也就是 Bash 4.1 或更新的版本）</div></blockquote><h3 id=升级-bash>升级 Bash</h3><p>后续说明假定你已使用 Bash 4.1+。你可以运行以下命令检查 Bash 版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span>
</code></pre></div><p>如果版本太旧，可以用 Homebrew 安装/升级：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash
</code></pre></div><p>重新加载 shell，并验证所需的版本已经生效：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b8860b>$BASH_VERSION</span> <span style=color:#b8860b>$SHELL</span>
</code></pre></div><p>Homebrew 通常把它安装为 <code>/usr/local/bin/bash</code>。</p><h3 id=安装-bash-completion>安装 bash-completion</h3><blockquote class="note callout"><div><strong>说明：</strong><p>如前所述，本说明假定你使用的 Bash 版本为 4.1+，这意味着你要安装 bash-completion v2
（不同于 Bash 3.2 和 bash-completion v1，kubectl 的补全功能在该场景下无法工作）。</div></blockquote><p>你可以用命令 <code>type _init_completion</code> 测试 bash-completion v2 是否已经安装。
如未安装，用 Homebrew 来安装它：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install bash-completion@2
</code></pre></div><p>如命令的输出信息所显示的，将如下内容添加到文件 <code>~/.bash_profile</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>export</span> <span style=color:#b8860b>BASH_COMPLETION_COMPAT_DIR</span><span style=color:#666>=</span><span style=color:#b44>&#34;/usr/local/etc/bash_completion.d&#34;</span>
<span style=color:#666>[[</span> -r <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span> <span style=color:#666>]]</span> <span style=color:#666>&amp;&amp;</span> . <span style=color:#b44>&#34;/usr/local/etc/profile.d/bash_completion.sh&#34;</span>
</code></pre></div><p>重新加载 shell，并用命令 <code>type _init_completion</code> 验证 bash-completion v2 已经恰当的安装。</p><h3 id=启用-kubectl-自动补全功能>启用 kubectl 自动补全功能</h3><p>你现在需要确保在所有的 shell 环境中均已导入（sourced） kubectl 的补全脚本，
有若干种方法可以实现这一点：</p><ul><li><p>在文件 <code>~/.bash_profile</code> 中导入（Source）补全脚本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li><p>将补全脚本添加到目录 <code>/usr/local/etc/bash_completion.d</code> 中：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl completion bash &gt;/usr/local/etc/bash_completion.d/kubectl
</code></pre></div></li></ul><ul><li><p>如果你为 kubectl 定义了别名，则可以扩展 shell 补全来兼容该别名：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bash_profile
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.bash_profile
</code></pre></div></li></ul><ul><li><p>如果你是用 Homebrew 安装的 kubectl（<a href=#install-with-homebrew-on-macos>如上所述</a>），
那么 kubectl 补全脚本应该已经安装到目录 <code>/usr/local/etc/bash_completion.d/kubectl</code> 中了。
这种情况下，你什么都不需要做。</p><blockquote class="note callout"><div><strong>说明：</strong><p>用 Hommbrew 安装的 bash-completion v2 会初始化 目录 <code>BASH_COMPLETION_COMPAT_DIR</code> 中的所有文件，这就是后两种方法能正常工作的原因。</div></blockquote></li></ul><p>总之，重新加载 shell 之后，kubectl 补全功能将立即生效。</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9ab27577326839cb4793fd670a916364>6 - zsh 自动补全</h1><div class=lead>zsh 自动补全的一些可选配置</div><p>kubectl 通过命令 <code>kubectl completion zsh</code> 生成 Zsh 自动补全脚本。
在 shell 中导入（Sourcing）该自动补全脚本，将启动 kubectl 自动补全功能。</p><p>为了在所有的 shell 会话中实现此功能，请将下面内容加入到文件 <code>~/.zshrc</code> 中。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>
</code></pre></div><p>如果你为 kubectl 定义了别名，可以扩展脚本补全，以兼容该别名。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=color:#a2f>echo</span> <span style=color:#b44>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.zshrc
<span style=color:#a2f>echo</span> <span style=color:#b44>&#39;complete -F __start_kubectl k&#39;</span> &gt;&gt;~/.zshrc
</code></pre></div><p>重新加载 shell 后，kubectl 自动补全功能将立即生效。</p><p>如果你收到 <code>complete:13: command not found: compdef</code> 这样的错误提示，那请将下面内容添加到 <code>~/.zshrc</code> 文件的开头：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>autoload -Uz compinit
compinit
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-99d563e9521796074ba3ca7f15a613ce>7 - 后续内容</h1><div class=lead>安装 kubectl 之后，还可以做些什么？</div><ul><li><a href=https://minikube.sigs.k8s.io/docs/start/>安装 Minikube</a></li><li>有关创建集群的更多信息，请参阅<a href=/zh/docs/setup/>入门指南</a>.</li><li><a href=/zh/docs/tasks/access-application-cluster/service-access-application-cluster/>学习如何启动并对外公开你的应用程序。</a></li><li>如果你需要访问其他人创建的集群，请参阅
<a href=/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>共享集群接入文档</a>.</li><li>阅读 <a href=/zh/docs/reference/kubectl/kubectl/>kubectl 参考文档</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f92adff24b39ef90a481e9aec2b8dd08>8 - 通过 gcloud 安装 kubectl</h1><div class=lead>用各个特定操作系统标签页中包含的 gcloud 指令片段安装 kubectl。</div><p>kubectl 可以作为 Google Cloud SDK 的一部分被安装。</p><ol><li><p>安装 <a href=https://cloud.google.com/sdk/>Google Cloud SDK</a>。</p></li><li><p>运行安装 <code>kubectl</code> 的命令：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud components install kubectl
</code></pre></div></li><li><p>验证一下，确保安装的是最新的版本：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl version --client
</code></pre></div></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-b2d43b2ae3e8f26eefa83de2db4ba782>9 - 验证 kubectl 的安装效果</h1><div class=lead>如何验证 kubectl。</div><p>为了让 kubectl 能发现并访问 Kubernetes 集群，你需要一个
<a href=/docs/zh/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig 文件</a>，
该文件在
<a href=https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh>kube-up.sh</a>
创建集群时，或成功部署一个 Miniube 集群时，均会自动生成。
通常，kubectl 的配置信息存放于文件 <code>~/.kube/config</code> 中。</p><p>通过获取集群状态的方法，检查是否已恰当的配置了 kubectl：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info
</code></pre></div><p>如果返回一个 URL，则意味着 kubectl 成功的访问到了你的集群。</p><p>如果你看到如下所示的消息，则代表 kubectl 配置出了问题，或无法连接到 Kubernetes 集群。</p><pre><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
（访问 &lt;server-name:port&gt; 被拒绝 - 你指定的主机和端口是否有误？）
</code></pre><p>例如，如果你想在自己的笔记本上（本地）运行 Kubernetes 集群，你需要先安装一个 Minikube 这样的工具，然后再重新运行上面的命令。</p><p>如果命令 <code>kubectl cluster-info</code> 返回了 url，但你还不能访问集群，那可以用以下命令来检查配置是否妥当：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cluster-info dump
</code></pre></div></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/zh/docs/home/>主页</a>
<a class=text-white href=/zh/blog/>博客</a>
<a class=text-white href=/zh/training/>培训</a>
<a class=text-white href=/zh/partners/>合作伙伴</a>
<a class=text-white href=/zh/community/>社区</a>
<a class=text-white href=/zh/case-studies/>案例分析</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes 作者 | 文档发布基于 <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a> 授权许可</small><br><small class=text-white>Copyright &copy; 2023 Linux 基金会&reg;。保留所有权利。Linux 基金会已注册并使用商标。如需了解 Linux 基金会的商标列表，请访问<a href=https://www.linuxfoundation.org/trademark-usage class=light-text>商标使用页面</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/popper-1.14.3.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=/js/bootstrap-4.3.1.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script src=/js/main.min.40616251a9b6e4b689e7769be0340661efa4d7ebb73f957404e963e135b4ed52.js integrity="sha256-QGFiUam25LaJ53ab4DQGYe+k1+u3P5V0BOlj4TW07VI=" crossorigin=anonymous></script></body></html>