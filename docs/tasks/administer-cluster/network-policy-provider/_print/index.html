<!doctype html><html lang=en class=no-js><head><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-36037335-10')</script><link rel=alternate hreflang=zh href=https://kubernetes.io/zh/docs/tasks/administer-cluster/network-policy-provider/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/tasks/administer-cluster/network-policy-provider/><link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/tasks/administer-cluster/network-policy-provider/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/tasks/administer-cluster/network-policy-provider/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.82.0"><link rel=canonical type=text/html href=https://kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>Install a Network Policy Provider | Kubernetes</title><meta property="og:title" content="Install a Network Policy Provider"><meta property="og:description" content="Production-Grade Container Orchestration"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="Install a Network Policy Provider"><meta itemprop=description content="Production-Grade Container Orchestration"><meta name=twitter:card content="summary"><meta name=twitter:title content="Install a Network Policy Provider"><meta name=twitter:description content="Production-Grade Container Orchestration"><link rel=preload href=/scss/main.min.aeea2a074ae7ac3d467a0d6f52e45894b49452cbb3f0f410c268ec7280c5a653.css as=style><link href=/scss/main.min.aeea2a074ae7ac3d467a0d6f52e45894b49452cbb3f0f410c268ec7280c5a653.css rel=stylesheet integrity><script src=/js/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png"}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content><meta property="og:description" content><meta name=twitter:description content><meta property="og:url" content="https://kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/"><meta property="og:title" content="Install a Network Policy Provider"><meta name=twitter:title content="Install a Network Policy Provider"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/script.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/docs/>Documentation</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/blog/>Kubernetes Blog</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/training/>Training</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/partners/>Partners</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/community/>Community</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/case-studies/>Case Studies</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/>v1.21</a>
<a class=dropdown-item href=https://v1-20.docs.kubernetes.io/docs/tasks/administer-cluster/network-policy-provider/>v1.20</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/tasks/administer-cluster/network-policy-provider/>中文 Chinese</a>
<a class=dropdown-item href=/ko/docs/tasks/administer-cluster/network-policy-provider/>한국어 Korean</a>
<a class=dropdown-item href=/fr/docs/tasks/administer-cluster/network-policy-provider/>Français</a>
<a class=dropdown-item href=/es/docs/tasks/administer-cluster/network-policy-provider/>Español</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/tasks/administer-cluster/network-policy-provider/>Return to the regular view of this page</a>.</p></div><h1 class=title>Install a Network Policy Provider</h1><ul><li>1: <a href=#pg-1239a77618c6278373832a142cd85519>Use Calico for NetworkPolicy</a></li><li>2: <a href=#pg-95039241255a31df196beaa405b68eba>Use Cilium for NetworkPolicy</a></li><li>3: <a href=#pg-505a0a6a7e6eff361bbb3be81c84b2e0>Use Kube-router for NetworkPolicy</a></li><li>4: <a href=#pg-2842eac98aa0e229a5c6755c4c83d2a7>Romana for NetworkPolicy</a></li><li>5: <a href=#pg-ac075c3fdfd0d41aa753cc70e42be064>Weave Net for NetworkPolicy</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-1239a77618c6278373832a142cd85519>1 - Use Calico for NetworkPolicy</h1><p>This page shows a couple of quick ways to create a Calico cluster on Kubernetes.</p><h2 id=before-you-begin>Before you begin</h2><p>Decide whether you want to deploy a <a href=#creating-a-calico-cluster-with-google-kubernetes-engine-gke>cloud</a> or <a href=#creating-a-local-calico-cluster-with-kubeadm>local</a> cluster.</p><h2 id=creating-a-calico-cluster-with-google-kubernetes-engine-gke>Creating a Calico cluster with Google Kubernetes Engine (GKE)</h2><p><strong>Prerequisite</strong>: <a href=https://cloud.google.com/sdk/docs/quickstarts>gcloud</a>.</p><ol><li><p>To launch a GKE cluster with Calico, include the <code>--enable-network-policy</code> flag.</p><p><strong>Syntax</strong></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud container clusters create <span style=color:#666>[</span>CLUSTER_NAME<span style=color:#666>]</span> --enable-network-policy
</code></pre></div><p><strong>Example</strong></p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gcloud container clusters create my-calico-cluster --enable-network-policy
</code></pre></div></li><li><p>To verify the deployment, use the following command.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods --namespace<span style=color:#666>=</span>kube-system
</code></pre></div><p>The Calico pods begin with <code>calico</code>. Check to make sure each one has a status of <code>Running</code>.</p></li></ol><h2 id=creating-a-local-calico-cluster-with-kubeadm>Creating a local Calico cluster with kubeadm</h2><p>To get a local single-host Calico cluster in fifteen minutes using kubeadm, refer to the
<a href=https://docs.projectcalico.org/latest/getting-started/kubernetes/>Calico Quickstart</a>.</p><h2 id=what-s-next>What's next</h2><p>Once your cluster is running, you can follow the <a href=/docs/tasks/administer-cluster/declare-network-policy/>Declare Network Policy</a> to try out Kubernetes NetworkPolicy.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-95039241255a31df196beaa405b68eba>2 - Use Cilium for NetworkPolicy</h1><p>This page shows how to use Cilium for NetworkPolicy.</p><p>For background on Cilium, read the <a href=https://docs.cilium.io/en/stable/intro>Introduction to Cilium</a>.</p><h2 id=before-you-begin>Before you begin</h2><p><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. If you do not already have a
cluster, you can create one by using
<a href=/docs/tasks/tools/#minikube>minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href=https://www.katacoda.com/courses/kubernetes/playground>Katacoda</a></li><li><a href=http://labs.play-with-k8s.com/>Play with Kubernetes</a></li></ul>To check the version, enter <code>kubectl version</code>.</p><h2 id=deploying-cilium-on-minikube-for-basic-testing>Deploying Cilium on Minikube for Basic Testing</h2><p>To get familiar with Cilium easily you can follow the
<a href=https://docs.cilium.io/en/stable/gettingstarted/minikube/>Cilium Kubernetes Getting Started Guide</a>
to perform a basic DaemonSet installation of Cilium in minikube.</p><p>To start minikube, minimal version required is >= v1.3.1, run the with the
following arguments:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>minikube version
</code></pre></div><pre><code>minikube version: v1.3.1
</code></pre><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>minikube start --network-plugin<span style=color:#666>=</span>cni --memory<span style=color:#666>=</span><span style=color:#666>4096</span>
</code></pre></div><p>Mount the BPF filesystem:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>minikube ssh -- sudo mount bpffs -t bpf /sys/fs/bpf
</code></pre></div><p>For minikube you can deploy this simple ''all-in-one'' YAML file that includes
DaemonSet configurations for Cilium as well as appropriate RBAC settings:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.8/install/kubernetes/quick-install.yaml
</code></pre></div><pre><code>configmap/cilium-config created
serviceaccount/cilium created
serviceaccount/cilium-operator created
clusterrole.rbac.authorization.k8s.io/cilium created
clusterrole.rbac.authorization.k8s.io/cilium-operator created
clusterrolebinding.rbac.authorization.k8s.io/cilium created
clusterrolebinding.rbac.authorization.k8s.io/cilium-operator created
daemonset.apps/cilium create
deployment.apps/cilium-operator created
</code></pre><p>The remainder of the Getting Started Guide explains how to enforce both L3/L4
(i.e., IP address + port) security policies, as well as L7 (e.g., HTTP) security
policies using an example application.</p><h2 id=deploying-cilium-for-production-use>Deploying Cilium for Production Use</h2><p>For detailed instructions around deploying Cilium for production, see:
<a href=https://docs.cilium.io/en/stable/concepts/kubernetes/intro/>Cilium Kubernetes Installation Guide</a>
This documentation includes detailed requirements, instructions and example
production DaemonSet files.</p><h2 id=understanding-cilium-components>Understanding Cilium components</h2><p>Deploying a cluster with Cilium adds Pods to the <code>kube-system</code> namespace. To see
this list of Pods run:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods --namespace<span style=color:#666>=</span>kube-system
</code></pre></div><p>You'll see a list of Pods similar to this:</p><pre><code class=language-console data-lang=console>NAME            READY   STATUS    RESTARTS   AGE
cilium-6rxbd    1/1     Running   0          1m
...
</code></pre><p>A <code>cilium</code> Pod runs on each node in your cluster and enforces network policy
on the traffic to/from Pods on that node using Linux BPF.</p><h2 id=what-s-next>What's next</h2><p>Once your cluster is running, you can follow the
<a href=/docs/tasks/administer-cluster/declare-network-policy/>Declare Network Policy</a>
to try out Kubernetes NetworkPolicy with Cilium.
Have fun, and if you have questions, contact us using the
<a href=https://cilium.herokuapp.com/>Cilium Slack Channel</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-505a0a6a7e6eff361bbb3be81c84b2e0>3 - Use Kube-router for NetworkPolicy</h1><p>This page shows how to use <a href=https://github.com/cloudnativelabs/kube-router>Kube-router</a> for NetworkPolicy.</p><h2 id=before-you-begin>Before you begin</h2><p>You need to have a Kubernetes cluster running. If you do not already have a cluster, you can create one by using any of the cluster installers like Kops, Bootkube, Kubeadm etc.</p><h2 id=installing-kube-router-addon>Installing Kube-router addon</h2><p>The Kube-router Addon comes with a Network Policy Controller that watches Kubernetes API server for any NetworkPolicy and pods updated and configures iptables rules and ipsets to allow or block traffic as directed by the policies. Please follow the <a href=https://www.kube-router.io/docs/user-guide/#try-kube-router-with-cluster-installers>trying Kube-router with cluster installers</a> guide to install Kube-router addon.</p><h2 id=what-s-next>What's next</h2><p>Once you have installed the Kube-router addon, you can follow the <a href=/docs/tasks/administer-cluster/declare-network-policy/>Declare Network Policy</a> to try out Kubernetes NetworkPolicy.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2842eac98aa0e229a5c6755c4c83d2a7>4 - Romana for NetworkPolicy</h1><p>This page shows how to use Romana for NetworkPolicy.</p><h2 id=before-you-begin>Before you begin</h2><p>Complete steps 1, 2, and 3 of the <a href=/docs/reference/setup-tools/kubeadm/>kubeadm getting started guide</a>.</p><h2 id=installing-romana-with-kubeadm>Installing Romana with kubeadm</h2><p>Follow the <a href=https://github.com/romana/romana/tree/master/containerize>containerized installation guide</a> for kubeadm.</p><h2 id=applying-network-policies>Applying network policies</h2><p>To apply network policies use one of the following:</p><ul><li><a href=https://github.com/romana/romana/wiki/Romana-policies>Romana network policies</a>.<ul><li><a href=https://github.com/romana/core/blob/master/doc/policy.md>Example of Romana network policy</a>.</li></ul></li><li>The NetworkPolicy API.</li></ul><h2 id=what-s-next>What's next</h2><p>Once you have installed Romana, you can follow the
<a href=/docs/tasks/administer-cluster/declare-network-policy/>Declare Network Policy</a>
to try out Kubernetes NetworkPolicy.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ac075c3fdfd0d41aa753cc70e42be064>5 - Weave Net for NetworkPolicy</h1><p>This page shows how to use Weave Net for NetworkPolicy.</p><h2 id=before-you-begin>Before you begin</h2><p>You need to have a Kubernetes cluster. Follow the
<a href=/docs/reference/setup-tools/kubeadm/>kubeadm getting started guide</a> to bootstrap one.</p><h2 id=install-the-weave-net-addon>Install the Weave Net addon</h2><p>Follow the <a href=https://www.weave.works/docs/net/latest/kubernetes/kube-addon/>Integrating Kubernetes via the Addon</a> guide.</p><p>The Weave Net addon for Kubernetes comes with a
<a href=https://www.weave.works/docs/net/latest/kubernetes/kube-addon/#npc>Network Policy Controller</a>
that automatically monitors Kubernetes for any NetworkPolicy annotations on all
namespaces and configures <code>iptables</code> rules to allow or block traffic as directed by the policies.</p><h2 id=test-the-installation>Test the installation</h2><p>Verify that the weave works.</p><p>Enter the following command:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -n kube-system -o wide
</code></pre></div><p>The output is similar to this:</p><pre><code>NAME                                    READY     STATUS    RESTARTS   AGE       IP              NODE
weave-net-1t1qg                         2/2       Running   0          9d        192.168.2.10    worknode3
weave-net-231d7                         2/2       Running   1          7d        10.2.0.17       worknodegpu
weave-net-7nmwt                         2/2       Running   3          9d        192.168.2.131   masternode
weave-net-pmw8w                         2/2       Running   0          9d        192.168.2.216   worknode2
</code></pre><p>Each Node has a weave Pod, and all Pods are <code>Running</code> and <code>2/2 READY</code>. (<code>2/2</code> means that each Pod has <code>weave</code> and <code>weave-npc</code>.)</p><h2 id=what-s-next>What's next</h2><p>Once you have installed the Weave Net addon, you can follow the
<a href=/docs/tasks/administer-cluster/declare-network-policy/>Declare Network Policy</a>
to try out Kubernetes NetworkPolicy. If you have any question, contact us at
<a href=https://github.com/weaveworks/weave#getting-help>#weave-community on Slack or Weave User Group</a>.</p></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/docs/home/>Home</a>
<a class=text-white href=/blog/>Blog</a>
<a class=text-white href=/training/>Training</a>
<a class=text-white href=/partners/>Partners</a>
<a class=text-white href=/community/>Community</a>
<a class=text-white href=/case-studies/>Case Studies</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/popper-1.14.3.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=/js/bootstrap-4.3.1.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script src=/js/main.min.40616251a9b6e4b689e7769be0340661efa4d7ebb73f957404e963e135b4ed52.js integrity="sha256-QGFiUam25LaJ53ab4DQGYe+k1+u3P5V0BOlj4TW07VI=" crossorigin=anonymous></script></body></html>